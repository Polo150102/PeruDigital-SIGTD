<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguimiento de Trámite - SIGTD</title>
    <link rel="stylesheet" href="style_header.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="style_footer.css">
    <style>
        .tracking-container {
            max-width: 700px;
            margin: 2rem auto;
            background-color: white;
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .tracking-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .form-group input {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .tracking-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .btn-search {
            padding: 0.75rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-search:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-clear {
            padding: 0.75rem;
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-clear:hover {
            background-color: #e5e7eb;
        }

        .result-section {
            display: none;
        }

        .result-section.active {
            display: block;
        }

        .no-results {
            background-color: var(--bg-light);
            padding: 2rem;
            border-radius: var(--radius);
            text-align: center;
            color: var(--text-gray);
        }

        .procedure-card {
            background: linear-gradient(135deg, #f8fafc 0%, white 100%);
            border: 2px solid var(--primary);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .card-header-tracking {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1.5rem;
            gap: 1rem;
        }

        .card-header-tracking h2 {
            color: var(--primary);
            font-size: 1.5rem;
            margin: 0;
        }

        .procedure-number {
            font-size: 0.85rem;
            color: var(--text-gray);
            font-family: monospace;
            background-color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .status-value {
            display: inline-block;
            padding: 0.5rem 1.25rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-value.pending {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-value.in-progress {
            background-color: rgba(30, 64, 175, 0.1);
            color: var(--primary);
        }

        .status-value.observed {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .card-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .info-item {
            font-size: 0.9rem;
        }

        .info-label {
            display: block;
            color: var(--text-gray);
            font-size: 0.8rem;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .info-value {
            display: block;
            color: var(--text-dark);
            font-weight: 500;
            word-break: break-word;
        }

        .progress-section h3 {
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .progress-bar {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            gap: 0.75rem;
        }

        .progress-stage {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .progress-stage-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--bg-light);
            border: 3px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-gray);
            transition: all 0.3s;
        }

        .progress-stage.completed .progress-stage-circle {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }

        .progress-stage.active .progress-stage-circle {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 0 4px rgba(30, 64, 175, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .progress-stage-label {
            font-size: 0.8rem;
            color: var(--text-gray);
            font-weight: 500;
        }

        .progress-stage.completed .progress-stage-label {
            color: var(--success);
        }

        .progress-stage.active .progress-stage-label {
            color: var(--primary);
            font-weight: 600;
        }

        .progress-line {
            flex: 1;
            height: 3px;
            background-color: var(--border-color);
            margin: 0 0.5rem;
        }

        .progress-stage.completed ~ .progress-line {
            background-color: var(--success);
        }

        .history-section {
            margin-top: 2rem;
        }

        .history-section h3 {
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
        }

        .history-table thead {
            background-color: var(--bg-light);
            border-bottom: 2px solid var(--border-color);
        }

        .history-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        .history-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .history-table tbody tr:hover {
            background-color: var(--bg-light);
        }

        .history-date {
            color: var(--text-gray);
            font-size: 0.85rem;
        }

        .action-links {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .action-links a,
        .action-links button {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.95rem;
        }

        .action-links .btn-primary-link {
            background-color: var(--accent);
            color: white;
        }

        .action-links .btn-primary-link:hover {
            background-color: #ea6c15;
            transform: translateY(-2px);
        }

        .action-links .btn-secondary-link {
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
        }

        .action-links .btn-secondary-link:hover {
            background-color: #e5e7eb;
        }

        @media (max-width: 768px) {
            .tracking-container {
                padding: 1.5rem;
            }

            .tracking-form {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .tracking-buttons {
                grid-template-columns: 1fr;
            }

            .card-info {
                grid-template-columns: 1fr;
            }

            .card-header-tracking {
                flex-direction: column;
            }

            .progress-bar {
                display: grid;
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .progress-line {
                height: 2px;
                margin: 0.5rem 0;
                width: 100%;
            }

            .history-table {
                font-size: 0.85rem;
            }

            .history-table th,
            .history-table td {
                padding: 0.75rem;
            }

            .action-links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <img src="img/SJM.png">
                <div class="logo">
                    
                    <h1>SIGTD</h1>
                    <p>Sistema Digital de Trámites</p>
                </div>
                <nav class="nav">
                    <a href="index.html" class="nav-link">Inicio</a>
                    <a href="catalogo_tramites.html" class="nav-link">Nuevo Trámite</a>
                    <a href="consulta-tramite.html" class="nav-link active">Consultar Estado</a>
                    <a href="admin.html" class="nav-link">Administración</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="page-header">
            <div class="container">
                <h2>Seguimiento de Trámite</h2>
                <p class="subtitle">Consulta el estado actualizado de tu solicitud</p>
            </div>
        </div>

        <div class="container">
            <!-- Search Form -->
            <div class="tracking-container">
                <h3 style="margin-bottom: 1.5rem; color: var(--text-dark);">Busca tu Trámite</h3>
                <div class="tracking-form">
                    <div class="form-group">
                        <label for="searchDni">DNI/RUC</label>
                        <input type="text" id="searchDni" placeholder="Ej: 12345678">
                    </div>
                    <div class="form-group">
                        <label for="searchExpedient">Nº de Expediente</label>
                        <input type="text" id="searchExpedient" placeholder="Ej: MJM-2025-001234">
                    </div>
                </div>
                <div class="tracking-buttons">
                    <button class="btn-search" onclick="searchTracking()">Consultar</button>
                    <button class="btn-clear" onclick="clearSearch()">Limpiar</button>
                </div>
            </div>

            <!-- Result Section -->
            <div id="resultContainer" class="result-section">
                <div class="tracking-container">
                    <!-- Result will be inserted here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Municipalidad de San Juan de Miraflores</h4>
                    <p>Av. Principal 123, San Juan de Miraflores</p>
                    <p>Teléfono: (01) 123-4567</p>
                </div>
                <div class="footer-section">
                    <h4>Enlaces Útiles</h4>
                    <a href="index.html">Inicio</a>
                    <a href="nuevo-tramite.html">Nuevo Trámite</a>
                    <a href="seguimiento-tramite.html">Seguimiento</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Municipalidad de San Juan de Miraflores. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script>    
        const sampleProcedures = [
            {
                expedient: 'MJM-2025-001234',
                dni: '12345678',
                procedure: 'Licencia de Funcionamiento',
                status: 'En Revisión',
                statusClass: 'in-progress',
                registerDate: '15/11/2024',
                stages: [
                    { name: 'Recibido', completed: true },
                    { name: 'En Revisión', completed: false, active: true },
                    { name: 'Observado', completed: false },
                    { name: 'Aprobado', completed: false }
                ],
                movements: [
                    { date: '15/11/2024 09:30', action: 'Solicitud registrada en el sistema', user: 'Sistema' },
                    { date: '15/11/2024 10:15', action: 'Documentos recibidos y validados', user: 'Responsable' },
                    { date: '16/11/2024 14:00', action: 'Iniciada revisión técnica', user: 'Inspector' },
                    { date: '18/11/2024 11:30', action: 'Solicitud en revisión', user: 'Jefe de Trámites' }
                ]
            },
            {
                expedient: 'MJM-2025-005678',
                dni: '87654321',
                procedure: 'Certificado de Domicilio',
                status: 'Aprobado',
                statusClass: 'completed',
                registerDate: '10/11/2024',
                stages: [
                    { name: 'Recibido', completed: true },
                    { name: 'En Revisión', completed: true },
                    { name: 'Observado', completed: true },
                    { name: 'Aprobado', completed: true, active: true }
                ],
                movements: [
                    { date: '10/11/2024 08:00', action: 'Solicitud registrada', user: 'Sistema' },
                    { date: '10/11/2024 11:00', action: 'Documentos validados', user: 'Responsable' },
                    { date: '11/11/2024 09:00', action: 'Revisión completada sin observaciones', user: 'Inspector' },
                    { date: '12/11/2024 10:30', action: 'Trámite aprobado - Certificado listo', user: 'Jefe de Trámites' }
                ]
            },
            {
                expedient: 'MJM-2025-009999',
                dni: '71408016',
                procedure: 'Permiso de Obra',
                status: 'Observado',
                statusClass: 'observed',
                registerDate: '05/11/2024',
                stages: [
                    { name: 'Recibido', completed: true },
                    { name: 'En Revisión', completed: true },
                    { name: 'Observado', completed: true, active: true },
                    { name: 'Aprobado', completed: false }
                ],
                movements: [
                    { date: '05/11/2024 07:30', action: 'Solicitud registrada', user: 'Sistema' },
                    { date: '06/11/2024 10:00', action: 'Documentos recibidos', user: 'Responsable' },
                    { date: '08/11/2024 15:30', action: 'Se detectaron observaciones en planos', user: 'Inspector' },
                    { date: '09/11/2024 13:00', action: 'Trámite en estado observado - Requiere correcciones', user: 'Jefe de Trámites' }
                ]
            }
        ];

        function renderResult(procedure) {
            const currentStageIndex = procedure.stages.findIndex(s => s.active);
            
            return `
                <div class="procedure-card">
                    <div class="card-header-tracking">
                        <div>
                            <h2>${procedure.procedure}</h2>
                            <div class="procedure-number">Expediente: ${procedure.expedient}</div>
                        </div>
                        <span class="status-value ${procedure.statusClass}">${procedure.status}</span>
                    </div>

                    <div class="card-info">
                        <div class="info-item">
                            <span class="info-label">DNI/RUC</span>
                            <span class="info-value">${procedure.dni}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Fecha de Registro</span>
                            <span class="info-value">${procedure.registerDate}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Estado Actual</span>
                            <span class="info-value" style="color: ${procedure.statusClass === 'completed' ? 'var(--success)' : procedure.statusClass === 'observed' ? 'var(--error)' : 'var(--primary)'}; font-weight: 700;">${procedure.status}</span>
                        </div>
                    </div>

                    <div class="progress-section">
                        <h3>Barra de Progreso</h3>
                        <div class="progress-bar">
                            ${procedure.stages.map((stage, index) => `
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1; gap: 0.5rem;">
                                    <div class="progress-stage ${stage.completed ? 'completed' : ''} ${stage.active ? 'active' : ''}">
                                        <div class="progress-stage-circle">${stage.completed ? '✓' : stage.active ? '●' : index + 1}</div>
                                        <div class="progress-stage-label">${stage.name}</div>
                                    </div>
                                    ${index < procedure.stages.length - 1 ? '<div class="progress-line" style="margin: 0 0.25rem;"></div>' : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>Historial de Movimientos</h3>
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Fecha y Hora</th>
                                    <th>Acción</th>
                                    <th>Usuario</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${procedure.movements.map(movement => `
                                    <tr>
                                        <td><span class="history-date">${movement.date}</span></td>
                                        <td>${movement.action}</td>
                                        <td>${movement.user}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div class="action-links">
                        <a href="nuevo-tramite.html" class="btn-primary-link">Realizar Otro Trámite</a>
                        <a href="index.html" class="btn-secondary-link">Volver al Inicio</a>
                    </div>
                </div>
            `;
        }

        function searchTracking() {
            const dni = document.getElementById('searchDni').value.trim();
            const expedient = document.getElementById('searchExpedient').value.trim().toUpperCase();
            const resultContainer = document.getElementById('resultContainer');

            if (!dni && !expedient) {
                alert('Por favor ingresa DNI o Nº de expediente');
                return;
            }

            const found = sampleProcedures.find(p => 
                (dni && p.dni === dni) || 
                (expedient && p.expedient === expedient)
            );

            if (found) {
                resultContainer.innerHTML = `<div class="tracking-container">${renderResult(found)}</div>`;
                resultContainer.classList.add('active');
            } else {
                resultContainer.innerHTML = `
                    <div class="tracking-container">
                        <div class="no-results">
                            <p style="font-size: 1.1rem; margin-bottom: 0.5rem;">No se encontró ningún trámite</p>
                            <p>Verifica que hayas ingresado correctamente tu DNI o número de expediente.</p>
                        </div>
                    </div>
                `;
                resultContainer.classList.add('active');
            }
        }

        function clearSearch() {
            document.getElementById('searchDni').value = '';
            document.getElementById('searchExpedient').value = '';
            document.getElementById('resultContainer').classList.remove('active');
            document.getElementById('searchDni').focus();
        }

        // Allow Enter key to search
        document.getElementById('searchExpedient').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchTracking();
        });

        document.getElementById('searchDni').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchTracking();
        });
    </script>
</body>
</html>
